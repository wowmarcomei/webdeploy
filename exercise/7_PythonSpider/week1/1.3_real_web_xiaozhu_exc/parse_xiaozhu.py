from bs4 import BeautifulSoup
import requests
import time

urls = ['http://bj.xiaozhu.com/search-duanzufang-p{}-0/'.format(str(i)) for i in range(1,14,1)]
links = []

links_test = ['http://bj.xiaozhu.com/fangzi/6214168916.html', 'http://bj.xiaozhu.com/fangzi/4506787914.html', 'http://bj.xiaozhu.com/fangzi/1514858935.html', 'http://bj.xiaozhu.com/fangzi/7993822716.html', 'http://bj.xiaozhu.com/fangzi/5786369314.html', 'http://bj.xiaozhu.com/fangzi/7178199616.html', 'http://bj.xiaozhu.com/fangzi/3442493330.html', 'http://bj.xiaozhu.com/fangzi/5940251916.html', 'http://bj.xiaozhu.com/fangzi/2764934363.html', 'http://bj.xiaozhu.com/fangzi/4387200214.html', 'http://bj.xiaozhu.com/fangzi/4299469213.html', 'http://bj.xiaozhu.com/fangzi/829076339.html', 'http://bj.xiaozhu.com/fangzi/8878945664.html', 'http://bj.xiaozhu.com/fangzi/2803985763.html', 'http://bj.xiaozhu.com/fangzi/8632758564.html', 'http://bj.xiaozhu.com/fangzi/6183242715.html', 'http://bj.xiaozhu.com/fangzi/8296429447.html', 'http://bj.xiaozhu.com/fangzi/1585671035.html', 'http://bj.xiaozhu.com/fangzi/8749609464.html', 'http://bj.xiaozhu.com/fangzi/6308527016.html', 'http://bj.xiaozhu.com/fangzi/3621641829.html', 'http://bj.xiaozhu.com/fangzi/4362986414.html', 'http://bj.xiaozhu.com/fangzi/1381797635.html', 'http://bj.xiaozhu.com/fangzi/3736377030.html', 'http://bj.xiaozhu.com/fangzi/1758721035.html', 'http://bj.xiaozhu.com/fangzi/5728651214.html', 'http://bj.xiaozhu.com/fangzi/1231348705.html', 'http://bj.xiaozhu.com/fangzi/7643354215.html', 'http://bj.xiaozhu.com/fangzi/1383114235.html', 'http://bj.xiaozhu.com/fangzi/2494948363.html', 'http://bj.xiaozhu.com/fangzi/4221285513.html', 'http://bj.xiaozhu.com/fangzi/4509468613.html', 'http://bj.xiaozhu.com/fangzi/541769701.html', 'http://bj.xiaozhu.com/fangzi/5335241814.html', 'http://bj.xiaozhu.com/fangzi/1448198735.html', 'http://bj.xiaozhu.com/fangzi/6891975515.html', 'http://bj.xiaozhu.com/fangzi/4246912914.html', 'http://bj.xiaozhu.com/fangzi/4542800813.html', 'http://bj.xiaozhu.com/fangzi/6081105816.html', 'http://bj.xiaozhu.com/fangzi/6844521616.html', 'http://bj.xiaozhu.com/fangzi/4358298214.html', 'http://bj.xiaozhu.com/fangzi/6782946915.html', 'http://bj.xiaozhu.com/fangzi/6060429016.html', 'http://bj.xiaozhu.com/fangzi/2913942963.html', 'http://bj.xiaozhu.com/fangzi/6779101116.html', 'http://bj.xiaozhu.com/fangzi/5978027716.html', 'http://bj.xiaozhu.com/fangzi/827978939.html', 'http://bj.xiaozhu.com/fangzi/370348700.html', 'http://bj.xiaozhu.com/fangzi/4206755530.html', 'http://bj.xiaozhu.com/fangzi/4901321714.html', 'http://bj.xiaozhu.com/fangzi/1127628878.html', 'http://bj.xiaozhu.com/fangzi/1721481035.html', 'http://bj.xiaozhu.com/fangzi/4069625530.html', 'http://bj.xiaozhu.com/fangzi/3760588330.html', 'http://bj.xiaozhu.com/fangzi/8045212116.html', 'http://bj.xiaozhu.com/fangzi/4070271929.html', 'http://bj.xiaozhu.com/fangzi/24007700.html', 'http://bj.xiaozhu.com/fangzi/5899508414.html', 'http://bj.xiaozhu.com/fangzi/1639212235.html', 'http://bj.xiaozhu.com/fangzi/5803802814.html', 'http://bj.xiaozhu.com/fangzi/6602628616.html', 'http://bj.xiaozhu.com/fangzi/2614246163.html', 'http://bj.xiaozhu.com/fangzi/4372171714.html', 'http://bj.xiaozhu.com/fangzi/6138551516.html', 'http://bj.xiaozhu.com/fangzi/4915383714.html', 'http://bj.xiaozhu.com/fangzi/3209886330.html', 'http://bj.xiaozhu.com/fangzi/4164421930.html', 'http://bj.xiaozhu.com/fangzi/370265101.html', 'http://bj.xiaozhu.com/fangzi/1824587435.html', 'http://bj.xiaozhu.com/fangzi/5958915516.html', 'http://bj.xiaozhu.com/fangzi/6942947715.html', 'http://bj.xiaozhu.com/fangzi/5237664414.html', 'http://bj.xiaozhu.com/fangzi/3781819430.html', 'http://bj.xiaozhu.com/fangzi/1386308035.html', 'http://bj.xiaozhu.com/fangzi/1905987571.html', 'http://bj.xiaozhu.com/fangzi/3224524530.html', 'http://bj.xiaozhu.com/fangzi/749583838.html', 'http://bj.xiaozhu.com/fangzi/2534208863.html', 'http://bj.xiaozhu.com/fangzi/6965797015.html', 'http://bj.xiaozhu.com/fangzi/1955070671.html', 'http://bj.xiaozhu.com/fangzi/795398939.html', 'http://bj.xiaozhu.com/fangzi/3425937929.html', 'http://bj.xiaozhu.com/fangzi/3872780529.html', 'http://bj.xiaozhu.com/fangzi/6383396516.html', 'http://bj.xiaozhu.com/fangzi/6950112015.html', 'http://bj.xiaozhu.com/fangzi/2083307381.html', 'http://bj.xiaozhu.com/fangzi/2729874363.html', 'http://bj.xiaozhu.com/fangzi/243886601.html', 'http://bj.xiaozhu.com/fangzi/1246664735.html', 'http://bj.xiaozhu.com/fangzi/6226479215.html', 'http://bj.xiaozhu.com/fangzi/6928164016.html', 'http://bj.xiaozhu.com/fangzi/4560575414.html', 'http://bj.xiaozhu.com/fangzi/311320501.html', 'http://bj.xiaozhu.com/fangzi/7242527815.html', 'http://bj.xiaozhu.com/fangzi/1575359735.html', 'http://bj.xiaozhu.com/fangzi/6509553516.html', 'http://bj.xiaozhu.com/fangzi/3280927130.html', 'http://bj.xiaozhu.com/fangzi/1370027235.html', 'http://bj.xiaozhu.com/fangzi/1775917035.html', 'http://bj.xiaozhu.com/fangzi/3673298030.html', 'http://bj.xiaozhu.com/fangzi/3063899729.html', 'http://bj.xiaozhu.com/fangzi/2375554362.html', 'http://bj.xiaozhu.com/fangzi/3430485230.html', 'http://bj.xiaozhu.com/fangzi/4332630314.html', 'http://bj.xiaozhu.com/fangzi/6542639415.html', 'http://bj.xiaozhu.com/fangzi/6069595516.html', 'http://bj.xiaozhu.com/fangzi/1829587734.html', 'http://bj.xiaozhu.com/fangzi/1926018370.html', 'http://bj.xiaozhu.com/fangzi/8068184616.html', 'http://bj.xiaozhu.com/fangzi/3287011830.html', 'http://bj.xiaozhu.com/fangzi/1158923905.html', 'http://bj.xiaozhu.com/fangzi/4002628730.html', 'http://bj.xiaozhu.com/fangzi/2441348663.html', 'http://bj.xiaozhu.com/fangzi/1626710435.html', 'http://bj.xiaozhu.com/fangzi/5934272016.html', 'http://bj.xiaozhu.com/fangzi/5417727414.html', 'http://bj.xiaozhu.com/fangzi/6652981516.html', 'http://bj.xiaozhu.com/fangzi/4160354230.html', 'http://bj.xiaozhu.com/fangzi/3393862130.html', 'http://bj.xiaozhu.com/fangzi/4057391929.html', 'http://bj.xiaozhu.com/fangzi/4655809414.html', 'http://bj.xiaozhu.com/fangzi/2686405963.html', 'http://bj.xiaozhu.com/fangzi/1150759505.html', 'http://bj.xiaozhu.com/fangzi/1137584154.html', 'http://bj.xiaozhu.com/fangzi/571677601.html', 'http://bj.xiaozhu.com/fangzi/1158730205.html', 'http://bj.xiaozhu.com/fangzi/3319741329.html', 'http://bj.xiaozhu.com/fangzi/4070739029.html', 'http://bj.xiaozhu.com/fangzi/5653374813.html', 'http://bj.xiaozhu.com/fangzi/4690734814.html', 'http://bj.xiaozhu.com/fangzi/1316801235.html', 'http://bj.xiaozhu.com/fangzi/6653145416.html', 'http://bj.xiaozhu.com/fangzi/2144493759.html', 'http://bj.xiaozhu.com/fangzi/5700411214.html', 'http://bj.xiaozhu.com/fangzi/5465434314.html', 'http://bj.xiaozhu.com/fangzi/6418528816.html', 'http://bj.xiaozhu.com/fangzi/2979492463.html', 'http://bj.xiaozhu.com/fangzi/3679756429.html', 'http://bj.xiaozhu.com/fangzi/3195706334.html', 'http://bj.xiaozhu.com/fangzi/3385754230.html', 'http://bj.xiaozhu.com/fangzi/5089883314.html', 'http://bj.xiaozhu.com/fangzi/5130777113.html', 'http://bj.xiaozhu.com/fangzi/6134247315.html', 'http://bj.xiaozhu.com/fangzi/2880893463.html', 'http://bj.xiaozhu.com/fangzi/4580314213.html', 'http://bj.xiaozhu.com/fangzi/2834984163.html', 'http://bj.xiaozhu.com/fangzi/5568044113.html', 'http://bj.xiaozhu.com/fangzi/5631504414.html', 'http://bj.xiaozhu.com/fangzi/5171917314.html', 'http://bj.xiaozhu.com/fangzi/2672288163.html', 'http://bj.xiaozhu.com/fangzi/6225467316.html', 'http://bj.xiaozhu.com/fangzi/5028993914.html', 'http://bj.xiaozhu.com/fangzi/5280212813.html', 'http://bj.xiaozhu.com/fangzi/1943752971.html', 'http://bj.xiaozhu.com/fangzi/307921901.html', 'http://bj.xiaozhu.com/fangzi/5893263214.html', 'http://bj.xiaozhu.com/fangzi/2597512263.html', 'http://bj.xiaozhu.com/fangzi/1801225135.html', 'http://bj.xiaozhu.com/fangzi/844329838.html', 'http://bj.xiaozhu.com/fangzi/5648125113.html', 'http://bj.xiaozhu.com/fangzi/1707553035.html', 'http://bj.xiaozhu.com/fangzi/1223197005.html', 'http://bj.xiaozhu.com/fangzi/3773111030.html', 'http://bj.xiaozhu.com/fangzi/4028771130.html', 'http://bj.xiaozhu.com/fangzi/2539940963.html', 'http://bj.xiaozhu.com/fangzi/3937778430.html', 'http://bj.xiaozhu.com/fangzi/2386536763.html', 'http://bj.xiaozhu.com/fangzi/4271196614.html', 'http://bj.xiaozhu.com/fangzi/6159216216.html', 'http://bj.xiaozhu.com/fangzi/4683883514.html', 'http://bj.xiaozhu.com/fangzi/1657828135.html', 'http://bj.xiaozhu.com/fangzi/582651101.html', 'http://bj.xiaozhu.com/fangzi/4121106030.html', 'http://bj.xiaozhu.com/fangzi/3568030629.html', 'http://bj.xiaozhu.com/fangzi/2000080371.html', 'http://bj.xiaozhu.com/fangzi/7833861115.html', 'http://bj.xiaozhu.com/fangzi/6179315215.html', 'http://bj.xiaozhu.com/fangzi/5006768314.html', 'http://bj.xiaozhu.com/fangzi/3498349229.html', 'http://bj.xiaozhu.com/fangzi/5658631914.html', 'http://bj.xiaozhu.com/fangzi/2775153262.html', 'http://bj.xiaozhu.com/fangzi/2986469263.html', 'http://bj.xiaozhu.com/fangzi/4263939214.html', 'http://bj.xiaozhu.com/fangzi/3676964329.html', 'http://bj.xiaozhu.com/fangzi/5417240614.html', 'http://bj.xiaozhu.com/fangzi/2137067059.html', 'http://bj.xiaozhu.com/fangzi/6297648116.html', 'http://bj.xiaozhu.com/fangzi/2838632663.html', 'http://bj.xiaozhu.com/fangzi/2969830263.html', 'http://bj.xiaozhu.com/fangzi/4637053514.html', 'http://bj.xiaozhu.com/fangzi/1141450765.html', 'http://bj.xiaozhu.com/fangzi/469818001.html', 'http://bj.xiaozhu.com/fangzi/1339353835.html', 'http://bj.xiaozhu.com/fangzi/2847779263.html', 'http://bj.xiaozhu.com/fangzi/1186387235.html', 'http://bj.xiaozhu.com/fangzi/2762955463.html', 'http://bj.xiaozhu.com/fangzi/3806207630.html', 'http://bj.xiaozhu.com/fangzi/6388530916.html', 'http://bj.xiaozhu.com/fangzi/4123651330.html', 'http://bj.xiaozhu.com/fangzi/3673166730.html', 'http://bj.xiaozhu.com/fangzi/4668251814.html', 'http://bj.xiaozhu.com/fangzi/7584075615.html', 'http://bj.xiaozhu.com/fangzi/3937816630.html', 'http://bj.xiaozhu.com/fangzi/6266184216.html', 'http://bj.xiaozhu.com/fangzi/4315934513.html', 'http://bj.xiaozhu.com/fangzi/4259632014.html', 'http://bj.xiaozhu.com/fangzi/3805574429.html', 'http://bj.xiaozhu.com/fangzi/6885201116.html', 'http://bj.xiaozhu.com/fangzi/1860397634.html', 'http://bj.xiaozhu.com/fangzi/4604002014.html', 'http://bj.xiaozhu.com/fangzi/6226303915.html', 'http://bj.xiaozhu.com/fangzi/5416099414.html', 'http://bj.xiaozhu.com/fangzi/1209886305.html', 'http://bj.xiaozhu.com/fangzi/5450957114.html', 'http://bj.xiaozhu.com/fangzi/4642007814.html', 'http://bj.xiaozhu.com/fangzi/2357825663.html', 'http://bj.xiaozhu.com/fangzi/3322308529.html', 'http://bj.xiaozhu.com/fangzi/2414874363.html', 'http://bj.xiaozhu.com/fangzi/5112134313.html', 'http://bj.xiaozhu.com/fangzi/4889153814.html', 'http://bj.xiaozhu.com/fangzi/4837906213.html', 'http://bj.xiaozhu.com/fangzi/6799887515.html', 'http://bj.xiaozhu.com/fangzi/4827585414.html', 'http://bj.xiaozhu.com/fangzi/3317353530.html', 'http://bj.xiaozhu.com/fangzi/3630749129.html', 'http://bj.xiaozhu.com/fangzi/684138601.html', 'http://bj.xiaozhu.com/fangzi/1087220178.html', 'http://bj.xiaozhu.com/fangzi/5069147014.html', 'http://bj.xiaozhu.com/fangzi/2705683163.html', 'http://bj.xiaozhu.com/fangzi/8019897015.html', 'http://bj.xiaozhu.com/fangzi/4569539114.html', 'http://bj.xiaozhu.com/fangzi/4251726514.html', 'http://bj.xiaozhu.com/fangzi/1778330835.html', 'http://bj.xiaozhu.com/fangzi/5852134814.html', 'http://bj.xiaozhu.com/fangzi/2519150963.html', 'http://bj.xiaozhu.com/fangzi/2164127160.html', 'http://bj.xiaozhu.com/fangzi/5483910314.html', 'http://bj.xiaozhu.com/fangzi/2658683262.html', 'http://bj.xiaozhu.com/fangzi/1570865935.html', 'http://bj.xiaozhu.com/fangzi/1761428435.html', 'http://bj.xiaozhu.com/fangzi/5700120114.html', 'http://bj.xiaozhu.com/fangzi/4658993014.html', 'http://bj.xiaozhu.com/fangzi/860516339.html', 'http://bj.xiaozhu.com/fangzi/5097557313.html', 'http://bj.xiaozhu.com/fangzi/2691819163.html', 'http://bj.xiaozhu.com/fangzi/1032405259.html', 'http://bj.xiaozhu.com/fangzi/1912813770.html', 'http://bj.xiaozhu.com/fangzi/2460011263.html', 'http://bj.xiaozhu.com/fangzi/1524374035.html', 'http://bj.xiaozhu.com/fangzi/1117452978.html', 'http://bj.xiaozhu.com/fangzi/6102010316.html', 'http://bj.xiaozhu.com/fangzi/7987496116.html', 'http://bj.xiaozhu.com/fangzi/1711658035.html', 'http://bj.xiaozhu.com/fangzi/1212546205.html', 'http://bj.xiaozhu.com/fangzi/4747101414.html', 'http://bj.xiaozhu.com/fangzi/4008511830.html', 'http://bj.xiaozhu.com/fangzi/3220092330.html', 'http://bj.xiaozhu.com/fangzi/674516701.html', 'http://bj.xiaozhu.com/fangzi/2148631760.html', 'http://bj.xiaozhu.com/fangzi/100762901.html', 'http://bj.xiaozhu.com/fangzi/4427895814.html', 'http://bj.xiaozhu.com/fangzi/2526666562.html', 'http://bj.xiaozhu.com/fangzi/2385644963.html', 'http://bj.xiaozhu.com/fangzi/6184752916.html', 'http://bj.xiaozhu.com/fangzi/3859127930.html', 'http://bj.xiaozhu.com/fangzi/3740989130.html', 'http://bj.xiaozhu.com/fangzi/3767834930.html', 'http://bj.xiaozhu.com/fangzi/707698039.html', 'http://bj.xiaozhu.com/fangzi/1652069135.html', 'http://bj.xiaozhu.com/fangzi/3195777330.html', 'http://bj.xiaozhu.com/fangzi/2581904363.html', 'http://bj.xiaozhu.com/fangzi/3860976229.html', 'http://bj.xiaozhu.com/fangzi/600604701.html', 'http://bj.xiaozhu.com/fangzi/3219610030.html', 'http://bj.xiaozhu.com/fangzi/4025760529.html', 'http://bj.xiaozhu.com/fangzi/5232846013.html', 'http://bj.xiaozhu.com/fangzi/4270586113.html', 'http://bj.xiaozhu.com/fangzi/3684474530.html', 'http://bj.xiaozhu.com/fangzi/4285501414.html', 'http://bj.xiaozhu.com/fangzi/2597552363.html', 'http://bj.xiaozhu.com/fangzi/1955671170.html', 'http://bj.xiaozhu.com/fangzi/4575905714.html', 'http://bj.xiaozhu.com/fangzi/6188718615.html', 'http://bj.xiaozhu.com/fangzi/1682672835.html', 'http://bj.xiaozhu.com/fangzi/1780047235.html', 'http://bj.xiaozhu.com/fangzi/7426075416.html', 'http://bj.xiaozhu.com/fangzi/1608282734.html', 'http://bj.xiaozhu.com/fangzi/5886103214.html', 'http://bj.xiaozhu.com/fangzi/1711910435.html', 'http://bj.xiaozhu.com/fangzi/4777530914.html', 'http://bj.xiaozhu.com/fangzi/400133201.html', 'http://bj.xiaozhu.com/fangzi/3746927330.html', 'http://bj.xiaozhu.com/fangzi/3197205257.html', 'http://bj.xiaozhu.com/fangzi/5413926414.html', 'http://bj.xiaozhu.com/fangzi/6572808416.html', 'http://bj.xiaozhu.com/fangzi/2996142862.html', 'http://bj.xiaozhu.com/fangzi/5820594214.html', 'http://bj.xiaozhu.com/fangzi/2497235262.html', 'http://bj.xiaozhu.com/fangzi/6835605416.html', 'http://bj.xiaozhu.com/fangzi/2832412462.html']

def get_link(url):
    wb_data = requests.get(url)
    soup = BeautifulSoup(wb_data.text,'lxml')
    time.sleep(4)

    links = soup.select('#page_list > ul > li > div.result_btm_con.lodgeunitname')
    hrefs = [row.get('detailurl') for row in links]
    print(hrefs)
    return hrefs

def get_links(links=None):
    for url in urls:
        links += get_link(url)

def get_details(url):
    wb_data = requests.get(url)
    soup = BeautifulSoup(wb_data.text,'lxml')
    time.sleep(4)

    titles = soup.select('body > div.wrap.clearfix.con_bg > div.con_l > div.pho_info > h4 > em')
    addresses = soup.select('body > div.wrap.clearfix.con_bg > div.con_l > div.pho_info > p > span')
    prices = soup.select('#pricePart > div.day_l > span')
    images = soup.select('#curBigImage')
    landlord_profiles = soup.select('#floatRightBox > div.js_box.clearfix > div.member_pic > a > img')
    landlord_names = soup.select('#floatRightBox > div.js_box.clearfix > div.w_240 > h6 > a')
    landlord_genders = 'Man' if soup.find_all('span',class_='member_boy_ico') else 'Woman'

    for title, address, price,image, landlord_profile,landlord_name, landlord_gender in zip(titles,addresses,prices,images,landlord_profiles,landlord_names,landlord_genders):
        data = {
            'title': title.get_text(),
            'address':address.get_text(),
            'price':price.get_text(),
            'image':image.get('src'),
            'landlord_profile':landlord_profile.get('src'),
            'landlord_name':landlord_name.get_text(),
            'landlord_gender':landlord_gender
        }
        print(data)


get_details('http://bj.xiaozhu.com/fangzi/6214168916.html')